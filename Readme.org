* Roadmap

** TODO Markup basics
   :LOGBOOK:
   CLOCK: [2022-04-11 Mon 12:06]--[2022-04-11 Mon 12:10] =>  0:04
   CLOCK: [2022-04-11 Mon 10:11]--[2022-04-11 Mon 11:09] =>  0:58
   CLOCK: [2022-04-10 Sun 20:07]--[2022-04-10 Sun 20:23] =>  0:16
   CLOCK: [2022-04-10 Sun 19:16]--[2022-04-10 Sun 20:06] =>  0:50
   CLOCK: [2022-04-09 Sat 11:58]--[2022-04-09 Sat 13:03] =>  1:05
   CLOCK: [2022-04-08 Fri 17:47]--[2022-04-08 Fri 18:47] =>  1:00
   CLOCK: [2022-04-08 Fri 16:21]--[2022-04-08 Fri 16:48] =>  0:27
   CLOCK: [2022-04-08 Fri 11:41]--[2022-04-08 Fri 12:20] =>  1:39
   CLOCK: [2022-04-08 Fri 10:09]--[2022-04-08 Fri 11:01] =>  0:52
   :END:
   - [ ] generic style page

   - [X] footer
   - [X] header

   - [ ] listing
   - [X] index

   - [X] buttons

   - [X] lang switches?

   - [ ] graphs and visualizations (for ratings)
** DONE get a working name

** TODO Multilanguage support PT/EN
*** DONE basic solution
*** TODO language flag
** TODO listing page (1/2 day)
*** DONE load listing data
    :LOGBOOK:
    CLOCK: [2022-04-05 Tue 15:59]--[2022-04-05 Tue 16:35] =>  0:36
    :END:

*** DONE Bundle leaflet
    :LOGBOOK:
    CLOCK: [2022-04-07 Thu 16:50]--[2022-04-07 Thu 17:51] =>  1:01
    :END:

*** DONE Display basic map
*** DONE display listing with addresses
    :LOGBOOK:
    CLOCK: [2022-04-05 Tue 16:46]--[2022-04-05 Tue 17:07] =>  0:21
    :END:
*** DONE Display markers and centre the map 1:20
    :LOGBOOK:
    CLOCK: [2022-04-07 Thu 21:32]--[2022-04-07 Thu 22:33] =>  1:01
    :END:
*** DONE load 30 school and check permliminary performance
    :LOGBOOK:
    CLOCK: [2022-04-07 Thu 20:53]--[2022-04-07 Thu 21:08] =>  0:15
    :END:

** TODO load 2014 data with addresses on the cgi/clj script (30 min)
*** TODO create bb task that parses the json and spits schools
*** TODO places list needs a display tag for municipio/district/etc
*** TODO Massage municipality of schools
** TODO places autocomplete (1h)

   places list gets loaded in the frontend and is used for autocomplete. No need to fetch the server
*** TODO styling
*** DONE edn file with names
*** DONE list of places
*** DONE lib that gets sugestions main/query-place-list
*** DONE place-match functionality  in frontend
** TODO routing (30)
** TODO page generator and pages (3 days)
   Generate a page from a Markdown to hiccup
*** TODO Build generator (1 day)
*** TODO Privacy policy, DPA (1-3 day at least...)
*** TODO about
*** TODO FAQ


*** DONE basic autocomplete flow
*** TODO icons/styling
*** DONE generate links from k
** TODO frontend page (1h)
*** TODO Language selector (20 min)
*** TODO bottom section (30 min)** TODO Data parsing (1h)
   parse a json file into the directory structure
** TODO Hosting (1 day)
** TODO display ratings (3 days)
*** TODO parse and import PDFs
*** TODO style listing page
** Technical/setup stuff
*** TODO Bunde css into less files

  - [X] how to require namespaces
  - [X] private github account
  - [X] cider repl with babashka setup
  - [X] slurp pdf

  - [X] shadow-clj build for frontend
  - [X] Workspaces build
  - [X] browser hot reload
  - +Address search box+
  - https://www.geoapify.com/pricing
  - https://leafletjs.com/SlavaUkraini/examples.html

  - [X] css pipeline
    - [X] basic less pipeline
    - [X] file watcher
    - +babashka file watcher+

** +Access if nominatim is valid and host it+


* Nominatim

https://github.com/mediagis/nominatim-docker/tree/master/4.0

docker run -it --rm -d \
  -e PBF_URL=https://download.geofabrik.de/europe/portugal-latest.osm.pbf \
  -e REPLICATION_URL=https://download.geofabrik.de/europe/portugal-updates/ \
  -p 8080:8080 \
  --name nominatim \
  mediagis/nominatim:4.0

http://localhost:8080/search.php?q=rua%20vale%20formoso
Docs: https://nominatim.org/release-docs/latest/api/Search/

* Util

** logs

docker exec -it clj_cgi_web_1 tail -f -n 20 /var/log/apache2/error.log

** babashka nrepl

local$ bb nrepl

then cider connect

* API

** Names endpoint

json endpoint that returns name sugestions and lat/long and others.

/names?q=rua+vale+formoso+lisboa

** less

lessc .src/less/main.less target/main.css

or

npx less-watch-compiler src/less/ target/css/

** hot reload by live.js
