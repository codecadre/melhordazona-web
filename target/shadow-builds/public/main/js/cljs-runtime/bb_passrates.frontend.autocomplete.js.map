{"version":3,"sources":["bb_passrates/frontend/autocomplete.cljs"],"mappings":";AAMA,qDAAA,rDAAMA;AAAN,AACE,IAAMC,MAAI,uBAAA,vBAAgBC;AAA1B,AACE,qBAAA,rBAAmBD;;AACnB,yBAAA,lBAAgBA;;AAEpB,wDAAA,xDAAME;AAAN,AACE,IAAMF,MAAI,uBAAA,vBAAgBC;AAA1B,AACE,qBAAA,rBAAmBD;;AACnB,yBAAA,lBAAgBA;;AAEpB,kDAAA,0DAAAG,5GAAMI;AAAN,AAAA,IAAAH,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;iBAAAA,bAAqDO;WAArD,AAAAL,4CAAAF,eAAA,lEAA4BI;QAA5B,AAAAF,4CAAAF,eAAA,/DAAiCK;mBAAjC,AAAAH,4CAAAF,eAAA,1EAAmCM;AAAnC,AACE,IAAME,KAAG,uBAAA,vBAAgBX;IACnBY,IAAE,uBAAA,vBAAgBZ;IAClBa,OAAK,oBAAIL,pBAAEM;IACXC,QAAM,kFAAA,lFAACC,+CAAOC,sHAAW,gDAAA,hDAACC,+DAAuBL,MAAMM;AAH7D,AAIE,eAAA,fAAeP,sBAAS,CAAA,gIAAA,hFAAS,AAACP,4CAAIe,6BAAIP,WAAU,AAACQ,eAAkBb;;AACvE,CAAM,AAAaI,cAAG,mDAAA,wDAAA,9DAAKL,uDAAUQ;;AACrC,AAAcJ,eAAGC;;AACjB,OAAaD;;AAEjB,+DAAA,/DAAMW;AAAN,AAEE,IAAMC,iBAAe,uBAAA,vBAAgBvB;AAArC,AACE,oBAAI,kCAAA,lCAAW,AAAauB;AAC1B,uCAAA,hCAAmBA;;AACnB,oCAAA,7BAAgBA;;;AAEtB,6DAAA,7DAAMC;AAAN,AACE,IAAMD,iBAAe,uBAAA,vBAAgBvB;AAArC,AACE,oCAAA,7BAAgBuB;;AAEpB,6DAAA,7DAAME;AAAN,AACE,IAAMF,iBAAe,uBAAA,vBAAgBvB;AAArC,AACE,uCAAA,hCAAmBuB;;AAEvB,+CAAA,/CAAMG,sGAAWC;AAAjB,AACE,IAAMC,eAAa,AAAA,AAAID;AAAvB,AACE,GAAI,iCAAA,hCAAG,AAACE,gBAAMD;AAEb,IAAME,iBAAe,uBAAA,vBAAgB9B;IAC9B+B,UAAQ,AAACC,4CAAI1B,gDAAa,AAAC2B,0CAAiBC,kCAAON;AAD1D,AAGE,CAAM,AAAaE,2BAAgB,AAACK,kDAAa,kDAAA,lDAACC,uDAAeL;;AACjE,AAACjC;;AACA,OAAC0B;;AAEJ,AACE,AAACC;;AACD,OAACxB;;;AAER,sDAAA,tDAAMoC;AAAN,AACE,IAAMC,QAAM,uBAAA,vBAAgBtC;AAA5B,AACE,oBAAMsC;AAAN,AACE,QAAM,AAAWA,gBAAOZ;;AAD1B","names":["bb-passrates.frontend.autocomplete/hide-char-limit","box","js/document","bb-passrates.frontend.autocomplete/display-char-limit","p__28856","map__28857","cljs.core/--destructure-map","cljs.core.get","bb-passrates.frontend.autocomplete/dom-build-li","name","k","search-field","suggestion","li","a","type","cljs.core/namespace","label","cljs.core.get_in","bb-passrates.shared.copy/copy-list","cljs.core.keyword","bb-passrates.shared.main/lang","bb-passrates.shared.main/seo","cljs.core/name","bb-passrates.frontend.autocomplete/dom-toggle-search-wrapper","search-wrapper","bb-passrates.frontend.autocomplete/dom-show-search-wrapper","bb-passrates.frontend.autocomplete/dom-hide-search-wrapper","bb-passrates.frontend.autocomplete/on-key-fn","ev","query-string","cljs.core/count","suggestion-box","li-html","cljs.core.map","bb-passrates.shared.main/query-place-list","bb-passrates.shared.places/places","clojure.string.join","cljs.core.interpose","bb-passrates.frontend.autocomplete/autocomplete-cmp","input"],"sourcesContent":["(ns bb-passrates.frontend.autocomplete\n  (:require [clojure.string :as clj-str]\n            [bb-passrates.shared.places :refer [places]]\n            [bb-passrates.shared.main :refer [query-place-list seo lang]]\n            [bb-passrates.shared.copy :refer [copy-list]]))\n\n(defn hide-char-limit []\n  (let [box (.querySelector js/document \".char-limit\")]\n    (.classList.remove box \"show\")\n    (.classList.add box \"hidden\")))\n\n(defn display-char-limit []\n  (let [box (.querySelector js/document \".char-limit\")]\n    (.classList.remove box \"hidden\")\n    (.classList.add box \"show\")))\n\n(defn dom-build-li [{:keys [name k search-field] :as suggestion}]\n  (let [li (.createElement js/document \"li\")\n        a (.createElement js/document \"a\")\n        type (-> k namespace)\n        label (get-in copy-list [(keyword \"autocomplete\" type) lang])]\n    (.setAttribute a \"href\" (str \"/\" (get seo type) \"/\" (clojure.core/name k)))\n    (set! (.-innerText a) (str name \" (\" label \")\"))\n    (.appendChild li a)\n    (.-outerHTML li)))\n\n(defn dom-toggle-search-wrapper\n  []\n  (let [search-wrapper (.querySelector js/document \".search-wrapper .search-input\")]\n    (if (.contains (.-classList search-wrapper) \"active\")\n      (.classList.remove search-wrapper \"active\")\n      (.classList.add search-wrapper \"active\"))))\n\n(defn dom-show-search-wrapper []\n  (let [search-wrapper (.querySelector js/document \".search-wrapper .search-input\")]\n    (.classList.add search-wrapper \"active\")))\n\n(defn dom-hide-search-wrapper []\n  (let [search-wrapper (.querySelector js/document \".search-wrapper .search-input\")]\n    (.classList.remove search-wrapper \"active\")))\n\n(defn on-key-fn [ev]\n  (let [query-string (-> ev .-target .-value)]\n    (if (> (count query-string) 1)\n\n     (let [suggestion-box (.querySelector js/document \".search-input .autocomplete-box\")\n            li-html (map dom-build-li (query-place-list places query-string))]\n\n       (set! (.-innerHTML suggestion-box) (clj-str/join (interpose \"\\n\" li-html)))\n       (hide-char-limit)\n        (dom-show-search-wrapper))\n\n     (do\n       (dom-hide-search-wrapper)\n       (display-char-limit)))))\n\n(defn autocomplete-cmp []\n  (let [input (.querySelector js/document \".search-wrapper .search-input input\" )]\n    (when input\n      (set! (.-onkeyup input) on-key-fn))))\n"]}